<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Auto-Flow Control Room</title>
  <style>
    html, body { width:100%; max-width:100%; overflow-x:hidden; }
    *, *::before, *::after { box-sizing:border-box; }

    body{
      margin:0;
      padding:1.25rem;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(circle at top, #0f172a 0, #020617 55%, #000 100%);
      color:#e5e7eb;
    }

    .shell{ display:grid; gap:1rem; }

    .header{
      display:flex;
      justify-content:space-between;
      align-items:baseline;
      gap:1rem;
    }
    h1{ margin:0; font-size:1.05rem; font-weight:800; letter-spacing:.02em; }
    .badge{
      font-size:.75rem;
      padding:.18rem .55rem;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.4);
      opacity:.9;
      white-space:nowrap;
    }

    .panel{
      display:grid;
      grid-template-columns:minmax(0,1fr);
      gap:1rem;
    }
    @media (min-width:60rem){
      .panel{ grid-template-columns:minmax(0,1fr) minmax(0,1fr); }
    }

    .card{
      border:1px solid rgba(148,163,184,.25);
      border-radius:16px;
      padding:1rem;
      background: linear-gradient(180deg, rgba(15,23,42,.75), rgba(2,6,23,.65));
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      min-width:0;
    }

    .controls{ display:flex; flex-wrap:wrap; gap:.45rem; margin-top:.25rem; }
    .btn{
      appearance:none;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(2,6,23,.45);
      color:#e5e7eb;
      border-radius:999px;
      padding:.4rem .65rem;
      font-size:.82rem;
      cursor:pointer;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(226,232,240,.55); background: rgba(2,6,23,.6); }
    .btn[aria-pressed="true"]{
      border-color: rgba(56,189,248,.75);
      box-shadow:0 0 0 3px rgba(56,189,248,.15);
    }

    .kvs{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:.82rem;
      opacity:.92;
      line-height:1.35;
      background: rgba(2,6,23,.45);
      border:1px solid rgba(148,163,184,.25);
      border-radius:12px;
      padding:.65rem .75rem;
      overflow-x:auto;
      min-width:0;
    }

    .stage{
      border-radius:16px;
      border:2px solid rgba(56,189,248,.55);
      background: rgba(2,6,23,.35);
      padding:.75rem;
      max-width:41rem;
      overflow-x:auto; /* Professor Solo rule */
      min-width:0;
    }

    .layout{
      display:grid;
      grid-template-columns:repeat(4, 1fr);
      gap:.6rem;
      min-width:0;
    }

    .item{
      border-radius:14px;
      border:1px solid rgba(236,72,153,.55);
      background: linear-gradient(180deg, rgba(236,72,153,.18), rgba(236,72,153,.08));
      padding:.6rem;
      min-width:0;
      position:relative;
    }

    .item .dom{
      display:inline-block;
      font-size:.72rem;
      opacity:.85;
      border:1px solid rgba(148,163,184,.35);
      border-radius:999px;
      padding:.08rem .45rem;
      margin-bottom:.35rem;
    }

    .wide2{ grid-column: span 2; }
    .wide3{ grid-column: span 3; }

    /* The “teleport” candidate: this is the one that jumps in dense mode */
    .teleport{
      border-color: rgba(250,204,21,.65);
      background: linear-gradient(180deg, rgba(250,204,21,.18), rgba(250,204,21,.08));
    }

    .note{
      margin:.75rem 0 0;
      font-size:.85rem;
      opacity:.85;
      line-height:1.35;
    }

    .callout{
      margin-top:.65rem;
      padding:.6rem .75rem;
      border-radius:14px;
      border:1px solid rgba(250,204,21,.45);
      background: rgba(250,204,21,.08);
      font-size:.85rem;
      line-height:1.35;
      opacity:.95;
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="header">
      <h1>Auto-Flow Control Room</h1>
      <span class="badge" id="badge">grid-auto-flow: row</span>
    </div>

    <div class="panel">
      <section class="card">
        <div class="kvs" id="kvs">grid-auto-flow: row</div>

        <div class="controls" role="group" aria-label="Auto-flow modes">
          <button class="btn" data-flow="row" aria-pressed="true">row</button>
          <button class="btn" data-flow="row dense" aria-pressed="false">row dense</button>
          <button class="btn" data-flow="column" aria-pressed="false">column</button>
        </div>

        <div class="callout">
          <strong>The contrived trap:</strong> item <strong>5</strong> is tiny. A gap appears earlier because item <strong>4</strong> can’t fit.
          In <code>row dense</code>, Grid backfills that gap — so item <strong>5</strong> can appear <em>above</em> items 6–10.
        </div>

        <p class="note">
          <strong>Watch for visual reordering:</strong> dense packing can reduce gaps, but it may also make the layout order differ from DOM order.
        </p>
      </section>

      <section class="card">
        <h2 style="margin:0 0 .6rem 0; font-size:1rem; font-weight:800;">Stage</h2>
        <div class="stage">
          <main class="layout" id="layout">
            <div class="item wide2"><div class="dom">DOM 1</div>span 2</div>
            <div class="item wide2"><div class="dom">DOM 2</div>span 2</div>

            <div class="item wide3"><div class="dom">DOM 3</div>span 3</div>
            <div class="item wide2"><div class="dom">DOM 4</div>span 2 (forces a gap behind)</div>

            <div class="item teleport"><div class="dom">DOM 5</div>tiny — jumps in dense</div>

            <div class="item"><div class="dom">DOM 6</div>normal</div>
            <div class="item"><div class="dom">DOM 7</div>normal</div>
            <div class="item"><div class="dom">DOM 8</div>normal</div>
            <div class="item"><div class="dom">DOM 9</div>normal</div>
            <div class="item"><div class="dom">DOM 10</div>normal</div>
          </main>
        </div>

        <p class="note">
          With <code>row</code>, the gap stays empty. With <code>row dense</code>, item <strong>5</strong> backfills it.
        </p>
      </section>
    </div>
  </div>

  <script>
    const layout = document.getElementById('layout');
    const kvs = document.getElementById('kvs');
    const badge = document.getElementById('badge');
    const buttons = [...document.querySelectorAll('button[data-flow]')];

    let flow = 'row';

    function apply(){
      layout.style.gridAutoFlow = flow;
      kvs.textContent = 'grid-auto-flow: ' + flow;
      badge.textContent = 'grid-auto-flow: ' + flow;

      buttons.forEach(b =>
        b.setAttribute('aria-pressed', String(b.getAttribute('data-flow') === flow))
      );
    }

    buttons.forEach(b => b.addEventListener('click', () => {
      flow = b.getAttribute('data-flow');
      apply();
    }));

    apply();
  </script>
</body>
</html>
